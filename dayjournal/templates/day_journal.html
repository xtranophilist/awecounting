{%  extends "dashboard.html" %}

{% block title %}Day Journal for {{ day_journal.date }}{% endblock %}

{% block breadcrumbs %}
    {{ block.super }}
    <li class="active"><a href="{% url "new_day_journal" %}">Day Journal</a></li>
{% endblock %}

{% block head_end %}
    <script src="http://localhost/acubor_static/js/vendors/knockout.js"></script>
    <script src="http://localhost/acubor_static/js/ko_lib.js"></script>
    <script src="http://localhost/acubor_static/js/base.js"></script>
    <script src="http://localhost/acubor_static/js/day_journal.js"></script>
    <script>
        $(document).ready(function () {
            {% load filters %}
            ko.applyBindings(new DayJournal({{ day_journal|jsonify }}));
        });
    </script>
{% endblock %}

{% block content %}

    {{ day_journal }}

    <div class="page-header position-relative">
        <h1>
            Day Journal for {{ day_journal.date }}
        </h1>
    </div>


    <div class="row-fluid collapse-group" data-bind="with: cash_sales">
        <div class="collapsible-head"><h2 data-bind="css: status">Cash Sales</h2>
            <span data-bind="text: message()"></span>
            <span class="collapse-show-on-expand pull-right">
                <button class="button" data-bind="click: addRow"><i class="icon-plus-sign" ></i> Add New Row</button>
            <button class="button" data-bind="click: save"><i class="icon-save"></i> Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </div>

        <div class="collapse">
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Sales Ledger</th>
                    <th class="span2">Amount</th>
                    <th class="span1"></th>
                </tr>
                </thead>

                <tbody id="cash-sales">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td>
                        <span class="wid-pad pull-left" data-bind="text: $index()+1"> </span>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.accounts_by_tag('Sales'), optionsText: 'name', optionsValue: 'id', value: account_id, optionsCaption: 'Choose an account..', select2: {}"></select>
                    </td>
                    <td data-bind="editableText: amount, numeric: true"></td>
                    <td align="center">
                        <button class="close" data-bind="click: $parent.removeRow">&times;</button>
                    </td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="row-fluid collapse-group" data-bind="with: cash_purchase">
        <div class="collapsible-head"><h2>Cash Purchase</h2>
            <span class="collapse-show-on-expand pull-right">
                <button class="button" data-bind="click: addRow"><i class="icon-plus-sign" ></i> Add New Row</button>
            <button class="button" data-bind="click: save"><i class="icon-save"></i> Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </div>
        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Purchase Ledger</th>
                    <th class="span2">Amount</th>
                    <th class="span1"></th>
                </tr>
                </thead>

                <tbody id="cash-purchase">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td>
                        <span class="wid-pad pull-left" data-bind="text: $index()+1"> </span>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.accounts_by_tag('Purchase'), optionsText: 'name', optionsValue: 'id', value: account_id, select2: {}"></select>
                    </td>
                    <td data-bind="editableText: amount"></td>
                    <td>
                        <button class="close" data-bind="click: $parent.removeRow">&times;</button>
                    </td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="row-fluid collapse-group" data-bind="with: cash_receipt">
        <div class="collapsible-head"><h2>Cash Receipt</h2>
            <span class="collapse-show-on-expand pull-right">
                <button class="button" data-bind="click: addRow"><i class="icon-plus-sign" ></i> Add New Row</button>
            <button class="button" data-bind="click: save"><i class="icon-save"></i> Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </div>
        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Receipt From</th>
                    <th class="span2">Amount</th>
                    <th class="span1"></th>
                </tr>
                </thead>

                <tbody id="cash-receipt">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td>
                        <span class="wid-pad pull-left" data-bind="text: $index()+1"> </span>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.accounts_by_tag('Receipt'), optionsText: 'name', optionsValue: 'id', value: account_id, select2: {}"></select>
                    </td>
                    <td data-bind="editableText: amount"></td>
                    <td>
                        <button class="close" data-bind="click: $parent.removeRow">&times;</button>
                    </td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="row-fluid collapse-group" data-bind="with: cash_payment">
        <div class="collapsible-head"><h2>Cash Payment</h2>
        <span class="collapse-show-on-expand pull-right">
                <button class="button" data-bind="click: addRow"><i class="icon-plus-sign" ></i> Add New Row</button>
            <button class="button" data-bind="click: save"><i class="icon-save"></i> Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </div>
        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Payment To</th>
                    <th class="span2">Amount</th>
                    <th class="span1"></th>
                </tr>
                </thead>

                <tbody id="cash-payment">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td>
                        <span class="wid-pad pull-left" data-bind="text: $index()+1"> </span>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.accounts_by_tag('Payment'), optionsText: 'name', optionsValue: 'id', value: account_id, select2: {}"></select>
                    </td>
                    <td data-bind="editableText: amount"></td>
                    <td>
                        <button class="close" data-bind="click: $parent.removeRow">&times;</button>
                    </td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <br/>

    <div class="row-fluid collapse-group" data-bind="with: credit_sales">
        <div class="collapsible-head"><h2>Credit Sales</h2>
            <span class="collapse-show-on-expand pull-right">
                <button class="button" data-bind="click: addRow"><i class="icon-plus-sign" ></i> Add New Row</button>
            <button class="button" data-bind="click: save"><i class="icon-save"></i> Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </div>

        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Sales Ledger</th>
                    <th class="span2">Customer</th>
                    <th class="span2">Amount</th>
                    <th class="span1"></th>
                </tr>
                </thead>

                <tbody id="credit-sales">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td>
                        <span class="wid-pad pull-left" data-bind="text: $index()+1"> </span>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.accounts_by_tag('Sales'), optionsText: 'name', optionsValue: 'id', value: account_cr_id, select2: {}"></select>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.accounts_by_tag(['Customer','Party'], true), optionsText: 'name', optionsValue: 'id', value: account_dr_id, select2: {}"></select>
                    </td>
                    <td data-bind="editableText: amount"></td>
                    <td align="center">
                        <button class="close" data-bind="click: $parent.removeRow">&times;</button>
                    </td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="row-fluid collapse-group" data-bind="with: credit_purchase">
        <div class="collapsible-head"><h2>Credit Purchase</h2>
            <span class="collapse-show-on-expand pull-right">
                <button class="button" data-bind="click: addRow"><i class="icon-plus-sign" ></i> Add New Row</button>
            <button class="button" data-bind="click: save"><i class="icon-save"></i> Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </div>
        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Purchase Ledger</th>
                    <th class="span2">Suppliers</th>
                    <th class="span2">Amount</th>
                    <th class="span1"></th>
                </tr>
                </thead>

                <tbody id="credit-purchase">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td>
                        <span class="wid-pad pull-left" data-bind="text: $index()+1"> </span>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.items, optionsText: 'name', optionsValue: 'id', value: item_id, select2: {}"></select>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.items, optionsText: 'name', optionsValue: 'id', value: item_id, select2: {}"></select>
                    </td>
                    <td data-bind="editableText: amount"></td>
                    <td>
                        <button class="close" data-bind="click: $parent.removeRow">&times;</button>
                    </td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="row-fluid collapse-group" data-bind="with: credit_expense">
        <div class="collapsible-head"><h2>Credit Expense</h2>
            <span class="collapse-show-on-expand pull-right">
                <button class="button" data-bind="click: addRow"><i class="icon-plus-sign" ></i> Add New Row</button>
            <button class="button" data-bind="click: save"><i class="icon-save"></i> Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </div>
        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Expense Head</th>
                    <th class="span2">Claimed By</th>
                    <th class="span2">Amount</th>
                    <th class="span1"></th>
                </tr>
                </thead>

                <tbody id="credit-expense">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td>
                        <span class="wid-pad pull-left" data-bind="text: $index()+1"> </span>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.items, optionsText: 'name', optionsValue: 'id', value: item_id, select2: {}"></select>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.items, optionsText: 'name', optionsValue: 'id', value: item_id, select2: {}"></select>
                    </td>
                    <td data-bind="editableText: amount"></td>
                    <td>
                        <button class="close" data-bind="click: $parent.removeRow">&times;</button>
                    </td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="row-fluid collapse-group" data-bind="with: credit_income">
        <div class="collapsible-head"><h2>Credit Income</h2>
        <span class="collapse-show-on-expand pull-right">
                <button class="button" data-bind="click: addRow"><i class="icon-plus-sign" ></i> Add New Row</button>
            <button class="button" data-bind="click: save"><i class="icon-save"></i> Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </div>
        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Income Head</th>
                    <th class="span2">Income From</th>
                    <th class="span2">Amount</th>
                    <th class="span1"></th>
                </tr>
                </thead>

                <tbody id="credit-income">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td>
                        <span class="wid-pad pull-left" data-bind="text: $index()+1"> </span>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.items, optionsText: 'name', optionsValue: 'id', value: item_id, select2: {}"></select>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.items, optionsText: 'name', optionsValue: 'id', value: item_id, select2: {}"></select>
                    </td>
                    <td data-bind="editableText: amount"></td>
                    <td>
                        <button class="close" data-bind="click: $parent.removeRow">&times;</button>
                    </td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <br/>

    <div class="row-fluid collapse-group" data-bind="with: summary_cash">
        <div class="collapsible-head"><h2>Summary: Cash & Cash Equivalent</h2>
        <span class="collapse-show-on-expand pull-right">
                <button class="button" data-bind="click: addRow">
                    <i class="icon-plus-sign" ></i> Add New Row
                </button>
            <button class="button" data-bind="click: save">Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </div>
        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Particulars</th>
                    <th class="span1">Opening</th>
                    <th class="span1">Inward</th>
                    <th class="span1">Outward</th>
                    <th class="span1">Closing</th>
                    <th class="span1">Actual</th>
                    <th class="span1">Difference</th>
                </tr>
                </thead>

                <tbody id="summary-cash">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td data-bind="text: $index+1"></td>
                    <td data-bind="text: particular()"></td>
                    <td data-bind="text: opening()">1000</td>
                    <td data-bind="text: inward()"></td>
                    <td data-bind="text: outward()"></td>
                    <td data-bind="text: closing()"></td>
                    <td data-bind="editableText: actual"></td>
                    <td data-bind="text: difference()"></td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="row-fluid collapse-group" data-bind="with: summary_transfers">
        <div class="collapsible-head"><h2>Summary: Transfers / Remittances</h2>
        <span class="collapse-show-on-expand pull-right">
                <button class="button" data-bind="click: addRow">
                    <i class="icon-plus-sign" ></i> Add New Row
                </button>
            <button class="button" data-bind="click: save">Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </div>
        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Transfer Type</th>
                    <th class="span1">Inward</th>
                    <th class="span1">Outward</th>
                </tr>
                </thead>

                <tbody id="summary-transfers">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td data-bind="text: $index+1">1</td>
                    <td data-bind="text: transfer_type()"></td>
                    <td data-bind="text: inward()"></td>
                    <td data-bind="text: outward()"></td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="row-fluid collapse-group" data-bind="with: summary_bank">
        <div class="collapsible-head"><h2>Summary: Bank</h2>
        <span class="collapse-show-on-expand pull-right">
                <button class="button" data-bind="click: addRow">
                    <i class="icon-plus-sign" ></i> Add New Row
                </button>
            <button class="button" data-bind="click: save">Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </div>
        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Bank Account</th>
                    <th class="span1">Card Deposit</th>
                    <th class="span1">Cash Deposit</th>
                    <th class="span1">Account Transfer+</th>
                    <th class="span1">Account Transfer-</th>
                </tr>
                </thead>

                <tbody id="summary-bank">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td data-bind="text: $index+1">1</td>
                    <td data-bind="text: bank_account_id"></td>
                    <td data-bind="text: card_deposit()"></td>
                    <td data-bind="text: cash_deposit()"></td>
                    <td data-bind="text: account_transfer_plus()"></td>
                    <td data-bind="text: account_transfer_minus()"></td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="row-fluid collapse-group" data-bind="with: summary_sales_tax">
        <div class="collapsible-head"><h2>Summary: Sales Tax</h2>
            <span class="collapse-show-on-expand pull-right">
                <button class="button" data-bind="click: addRow"><i class="icon-plus-sign" ></i> Add New Row</button>
            <button class="button" data-bind="click: save"><i class="icon-save"></i> Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </div>

        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Type of Tax</th>
                    <th class="span2">Amount</th>
                    <th class="span1"></th>
                </tr>
                </thead>

                <tbody id="summary-sales-tax">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td>
                        <span class="wid-pad pull-left" data-bind="text: $index()+1"> </span>
                    </td>
                    <td>

                    </td>
                    <td data-bind="editableText: amount"></td>
                    <td align="center">
                        <button class="close" data-bind="click: $parent.removeRow">&times;</button>
                    </td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>



{% endblock %}