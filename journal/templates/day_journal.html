{%  extends "dashboard.html" %}

{% block title %}Day Book for {{ journal.date }}{% endblock %}

{% block breadcrumbs %}
    {{ block.super }}
    <li class="active"><a href="{% url "new_day_journal" %}">Day Book</a></li>
{% endblock %}

{% block head_end %}
    <script src="http://static.acubor.com/js/vendors/knockout.js"></script>
    <script src="http://static.acubor.com/js/ko_lib.js"></script>
    <script src="http://static.acubor.com/js/base.js"></script>
    {#    <script src="http://static.acubor.com/js/day_journal.js"></script>#}
    <script>
        $(document).ready(function () {
            {% load filters %}
            {#            ko.applyBindings(new DayJournal({{ journal|jsonify }}));#}
        });
    </script>
{% endblock %}

{% block content %}

    <div class="page-header position-relative">
        <h1>
            Day Book for {{ journal.date }}
        </h1>
    </div>

    {{ journal|jsonify }}

    <div class="row-fluid collapse-group" data-bind="with: cash_sales">
        <h2 class="collapsible-head">Cash Sales
            <span class="collapse-show-on-expand">
                <button class="button" data-bind="click: addRow">
                    <i class="icon-plus-sign hand-on-hover" ></i> Add New Row
                </button>
            <button class="button" data-bind="click: save">Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </h2>

        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Sales Ledger</th>
                    <th class="span2">Amount</th>
                    <th class="span1"></th>
                </tr>
                </thead>

                <tbody id="day-cash-sales">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td>
                        <span class="wid-pad pull-left" data-bind="text: $index()+1"> </span>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.items, optionsText: 'name', optionsValue: 'id', value: item_id, select2: {}"></select>
                    </td>
                    <td data-bind="editableText: amount"></td>
                    <td align="center">
                        <button class="close" data-bind="click: $parent.removeRow">&times;</button>
                    </td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="row-fluid collapse-group" data-bind="with: day_cash_purchase">
        <h2 class="collapsible-head">Cash Purchase
            <span class="collapse-show-on-expand">
                <button class="button" data-bind="click: addRow">
                    <i class="icon-plus-sign hand-on-hover" ></i> Add New Row
                </button>
            <button class="button" data-bind="click: save">Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </h2>
        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Purchase Ledger</th>
                    <th class="span2">Amount</th>
                    <th class="span1"></th>
                </tr>
                </thead>

                <tbody id="day-cash-purchase">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td>
                        <span class="wid-pad pull-left" data-bind="text: $index()+1"> </span>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.items, optionsText: 'name', optionsValue: 'id', value: item_id, select2: {}"></select>
                    </td>
                    <td data-bind="editableText: amount"></td>
                    <td>
                        <button class="close" data-bind="click: $parent.removeRow">&times;</button>
                    </td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="row-fluid collapse-group" data-bind="with: day_cash_receipt">
        <h2 class="collapsible-head">Cash Receipt
            <span class="collapse-show-on-expand">
                <button class="button" data-bind="click: addRow">
                    <i class="icon-plus-sign hand-on-hover" ></i> Add New Row
                </button>
            <button class="button" data-bind="click: save">Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </h2>
        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Receipt From</th>
                    <th class="span2">Amount</th>
                    <th class="span1"></th>
                </tr>
                </thead>

                <tbody id="day-cash-receipt">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td>
                        <span class="wid-pad pull-left" data-bind="text: $index()+1"> </span>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.items, optionsText: 'name', optionsValue: 'id', value: item_id, select2: {}"></select>
                    </td>
                    <td data-bind="editableText: amount"></td>
                    <td>
                        <button class="close" data-bind="click: $parent.removeRow">&times;</button>
                    </td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="row-fluid collapse-group" data-bind="with: day_cash_payment">
        <h2 class="collapsible-head">Cash Payment
        <span class="collapse-show-on-expand">
                <button class="button" data-bind="click: addRow">
                    <i class="icon-plus-sign hand-on-hover" ></i> Add New Row
                </button>
            <button class="button" data-bind="click: save">Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </h2>
        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span1">SN</th>
                    <th class="span2">Payment To</th>
                    <th class="span2">Amount</th>
                    <th class="span1"></th>
                </tr>
                </thead>

                <tbody id="day-cash-payment">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td>
                        <span class="wid-pad pull-left" data-bind="text: $index()+1"> </span>
                    </td>
                    <td>
                        <select class="span12" data-bind="options: $root.items, optionsText: 'name', optionsValue: 'id', value: item_id, select2: {}"></select>
                    </td>
                    <td data-bind="editableText: amount"></td>
                    <td>
                        <button class="close" data-bind="click: $parent.removeRow">&times;</button>
                    </td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

    <br/>

    <div class="row-fluid collapse-group" data-bind="with: day_summary_cash">
        <h2 class="collapsible-head">Summary Cash
        <span class="collapse-show-on-expand">
                <button class="button" data-bind="click: addRow">
                    <i class="icon-plus-sign hand-on-hover" ></i> Add New Row
                </button>
            <button class="button" data-bind="click: save">Save</button>
            <button class="button" data-bind="click: reset">Reset</button>
            </span>
        </h2>
        <div class="collapse">
            <div data-bind="text: message()"></div>
            <table class="table table-bordered table-striped table-acubor table-sortable">
                <thead>
                <tr>
                    <th class="span2">Opening</th>
                    <th class="span2">Inward</th>
                    <th class="span2">Outward</th>
                    <th class="span2">Closing</th>
                    <th class="span2">Actual</th>
                    <th class="span2">Difference</th>
                </tr>
                </thead>

                <tbody id="day-summary-cash">
                <!-- ko foreach: rows -->
                <tr data-bind="flash: true">
                    <td data-bind="text: opening()"></td>
                    <td data-bind="text: inward()"></td>
                    <td data-bind="text: outward()"></td>
                    <td data-bind="text: closing()"></td>
                    <td data-bind="editableText: actual"></td>
                    <td data-bind="text: difference()"></td>
                </tr>
                <!-- /ko -->
                </tbody>
            </table>
        </div>
    </div>

{% endblock %}